3.2.1.1 Internal Network Abuse via misconfigured Squid Proxy Server Description: Application domain is configured using "Squid Proxy" server which routes user's HTTP request to domains hosted on the network. When user make an HTTP request to domain, Squid Proxy server get the Domain name specified in "Host" header and forward the request to that specified domain (if it is reachable) and pass back the HTTP response of the request. Here, attacker can take advantage of proxy server to access the HTTP server hosted on internal network if he/she knows the internal IP address of the server. Squid proxy server is acting as DNS server and also resolves the IP of the domain before forwarding the request. Squid proxy server respond back with error messages if domain’s DNS entry is not present, IP is not reachable, Domain/IP port is not open (For example, "No DNS record" error message if there is no DNS entry for the domain, "No route to Host" if IP is not reachable, "connection refused" if port is not open). Proxy server maps the Domain name to IP and then perform other action. This behaviour of proxy server leads to disclosure of the network Internal IP of the domain. Proxy server discloses its hostname (revproxyprod04.dmz.local) in the footer of the error page

Squid proxy server should be configured in such way so that it allows only HTTP request for legit domains and block rest of the request including the request to access the web server hosted on internal IPs. 